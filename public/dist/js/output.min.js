function sendData(a){a.cards.forEach(function(a){delete a.$$hashKey}),ws.send(JSON.stringify(a))}function cardController(a){a.parsedJSON={},a.addCard=function(){var b=a.tags.split(","),c={title:a.title,desc:a.description,tags:b};a.parsedJSON.cards.push(c),sendData(a.parsedJSON)},a.removeCard=function(b){var c=a.parsedJSON.cards.indexOf(b);a.parsedJSON.cards.splice(c,1),angular.element("[data-ng-controller=cardController").scope().$apply(),sendData(a.parsedJSON)}}var app=angular.module("cardApp",[]).controller("cardController",["$scope","$http",cardController]),ws;$(window).load(function(){var a=location.origin.replace(/^http/,"ws");ws=new WebSocket(a),ws.onmessage=function(a){var b=JSON.parse(a.data);angular.element("[data-ng-controller=cardController]").scope().parsedJSON=b,angular.element("[data-ng-controller=cardController]").scope().$apply()},ws.onclose=function(){}}),$(window).on("beforeunload",function(){ws.close()});