function addToEntries(a){entries.length>50&&(entries=entries.splice(1,input.length-1)),entries.push(a);var b="";entries.forEach(function(a){b+=a+"<br/>"}),$("#output").html(b)}function submitInput(){var a=$("#input").val();if(""!==a){$("#input").val("");var b="";"password"===$("#input").attr("type")?(a=CryptoJS.SHA3(a),ws.send(a),b="******"):(ws.send(a),b=a),addToEntries('<span class="input-text">'+b+"</span>")}$("#input").attr("disabled","disabled")}var host=location.origin.replace(/^http/,"ws"),ws=new WebSocket(host);ws.onmessage=function(a){var b=JSON.parse(a.data);addToEntries('<span class="output-text">'+b.message+"</span>"),b.obfuscateInput?($("#input").attr("type","password"),$("#input-type-indicator").html("***")):($("#input").attr("type","text"),$("#input-type-indicator").html("abc")),$("#input").removeAttr("disabled"),$("#input").focus()},ws.onclose=function(){addToEntries('<span class="output-text">Connection lost. Please refresh to begin a new session.</span>'),$("#input").attr("disabled","disabled")};var entries=[];$(window).load(function(){addToEntries('<span class="output-text">Welcome to TextWorld.</span>'),$("#send").click(submitInput),$("#input").keyup(function(a){13==a.keyCode&&submitInput()})}),$(window).on("beforeunload",function(){ws.close()});